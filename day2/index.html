
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/SIB_logo.svg">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.6">
    
    
      
        <title>Day 2 - Introduction to statistics with R</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hypothesis-testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Introduction to statistics with R" class="md-header__button md-logo" aria-label="Introduction to statistics with R" data-md-component="logo">
      
  <img src="../assets/images/SIB_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction to statistics with R
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Day 2
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sib-swiss/Introduction-to-statistics-with-R" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sib-swiss/Introduction-to-statistics-with-R
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Introduction to statistics with R" class="md-nav__button md-logo" aria-label="Introduction to statistics with R" data-md-component="logo">
      
  <img src="../assets/images/SIB_logo.svg" alt="logo">

    </a>
    Introduction to statistics with R
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sib-swiss/Introduction-to-statistics-with-R" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sib-swiss/Introduction-to-statistics-with-R
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../precourse/" class="md-nav__link">
        Precourse preparation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../course_schedule/" class="md-nav__link">
        Course schedule
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../day1/" class="md-nav__link">
        Day 1
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Day 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Day 2
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-1-one-sample-t-test" class="md-nav__link">
    Exercise 1: One-sample t-test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2-two-sample-t-test" class="md-nav__link">
    Exercise 2: Two-sample t-test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3-paired-t-test" class="md-nav__link">
    Exercise 3: Paired t-test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-4-simulation-of-mice-weight-data-and-p-values" class="md-nav__link">
    Exercise 4: Simulation of mice weight data and p values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-5-anova" class="md-nav__link">
    Exercise 5: ANOVA
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../day3/" class="md-nav__link">
        Day 3
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../day4/" class="md-nav__link">
        Day 4
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../bonus_code/" class="md-nav__link">
        Bonus code
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../exam/" class="md-nav__link">
        Exam
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../links/" class="md-nav__link">
        Useful links
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-1-one-sample-t-test" class="md-nav__link">
    Exercise 1: One-sample t-test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2-two-sample-t-test" class="md-nav__link">
    Exercise 2: Two-sample t-test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3-paired-t-test" class="md-nav__link">
    Exercise 3: Paired t-test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-4-simulation-of-mice-weight-data-and-p-values" class="md-nav__link">
    Exercise 4: Simulation of mice weight data and p values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-5-anova" class="md-nav__link">
    Exercise 5: ANOVA
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/sib-swiss/Introduction-to-statistics-with-R/edit/master/docs/day2.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="hypothesis-testing">Hypothesis Testing</h1>
<p>In this section, you will find the R code that we will use during the course. We will explain the code and output during correction of the exercises.</p>
<p>Slides of lectures:</p>
<p><a class="md-button" href="../assets/pdf/Parametric%20and%20non%20parametric%20tests%20-%20090221.pdf">Download slides Morning</a>
<a class="md-button" href="../assets/pdf/ANOVA%20and%20confidence%20intervals%20-%20090221.pdf">Download slides Afternoon</a></p>
<p>The purpose of this exercise is to help you to better interpret a p-value by using R for introducing you to some simple hypothesis testing functions. As usual, be sure to read the help documentation for any new functions.</p>
<h2 id="exercise-1-one-sample-t-test">Exercise 1: One-sample t-test</h2>
<p>We use the intake data, available in the ISwR package. We will use the variable pre.</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">ISwR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span> <span class="c1">#we will show you how to do some standard ggplots</span>
<span class="nf">data</span><span class="p">(</span><span class="n">intake</span><span class="p">)</span>
<span class="o">?</span><span class="n">intake</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">intake</span><span class="p">)</span>
<span class="n">intake</span>
</code></pre></div>
<p>Start off by looking at some simple summary statistics: mean, sd, quantile (hardly necessary for such a small data set, but good practice).</p>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">intake</span><span class="p">)</span>
<span class="nf">mean</span><span class="p">(</span><span class="n">intake</span><span class="o">$</span><span class="n">pre</span><span class="p">)</span>
<span class="nf">sd</span><span class="p">(</span><span class="n">intake</span><span class="o">$</span><span class="n">pre</span><span class="p">)</span>
</code></pre></div>
</details>
<p>Might these data be approximately normally distributed? </p>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Assumption: no significant outliers in the data</span>
<span class="nf">ggboxplot</span><span class="p">(</span><span class="n">intake</span><span class="o">$</span><span class="n">pre</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="s">&quot;jitter&quot;</span><span class="p">),</span><span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;premenstrual intake&quot;</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>

<span class="nf">identify_outliers</span><span class="p">(</span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">intake</span><span class="o">$</span><span class="n">pre</span><span class="p">))</span>

<span class="c1"># Assumption: normality</span>
<span class="nf">ggqqplot</span><span class="p">(</span><span class="n">intake</span><span class="p">,</span><span class="s">&quot;pre&quot;</span><span class="p">)</span>
<span class="nf">shapiro_test</span><span class="p">(</span><span class="n">intake</span><span class="o">$</span><span class="n">pre</span><span class="p">)</span>
</code></pre></div>
</details>
<p>Suppose you wish to test whether there is a systematic deviation between the women&rsquo;s (pre) energy intake and a recommended value of 7725 kJ. Assuming that the data are from a normal distribution, we are interested in testing whether the (population) mean is 7725. We can do a t-test in R as follows:</p>
<p><div class="highlight"><pre><span></span><code><span class="nf">t.test</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="m">7725</span><span class="p">)</span>
</code></pre></div>
Any idea what the argument alternative is doing ? </p>
<div class="highlight"><pre><span></span><code><span class="nf">t.test</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="m">7725</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;less&quot;</span><span class="p">)</span>
</code></pre></div>
<p>There are several components to the output, Take some time to make sure you can understand what it all means. For an alpha level of 0.05, do you reject the null hypothesis? What about for an alpha level of 0.01?</p>
<p>The default assumes that you want a 2-sided test. Use help to find out how you could get a 1-sided test that would be meaningful for the dataset, and carry this out. For an alpha level of 0.01, do you reject the null hypothesis?</p>
<h2 id="exercise-2-two-sample-t-test">Exercise 2: Two-sample t-test</h2>
<p>We use the energy data to illustrate the use of t.test for testing equality of population means based on two independent samples. Here, we wish to compare mean energy expenditure between lean and obese women.</p>
<p><div class="highlight"><pre><span></span><code><span class="nf">data</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
<span class="o">?</span><span class="n">energy</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
<span class="n">energy</span>
</code></pre></div>
What are the assumptions you need to check for carring out a test ?</p>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># assumption 1: data in each group are normally distributed.</span>

<span class="n">ind.obese</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">energy</span><span class="o">$</span><span class="n">stature</span> <span class="o">==</span> <span class="s">&quot;obese&quot;</span><span class="p">)</span>
<span class="n">ind.lean</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">energy</span><span class="o">$</span><span class="n">stature</span> <span class="o">==</span> <span class="s">&quot;lean&quot;</span><span class="p">)</span>

<span class="nf">shapiro_test</span><span class="p">(</span><span class="n">energy</span><span class="o">$</span><span class="n">expend</span><span class="p">[</span><span class="n">ind.obese</span><span class="p">])</span> 
<span class="nf">shapiro_test</span><span class="p">(</span><span class="n">energy</span><span class="o">$</span><span class="n">expend</span><span class="p">[</span><span class="n">ind.lean</span><span class="p">])</span> 

<span class="c1"># assumption 2: the variances for the two independent groups are equal.</span>

<span class="nf">levene_test</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">expend</span><span class="o">~</span><span class="n">stature</span><span class="p">)</span>
<span class="c1"># if the command above does not work, use the levene test from the car package</span>
<span class="n">car</span><span class="o">::</span><span class="nf">leveneTest</span><span class="p">(</span><span class="n">expend</span><span class="o">~</span><span class="n">stature</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="s">&quot;median&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<p>The variable stature gives the grouping. The test can be carried out as follows:
<div class="highlight"><pre><span></span><code><span class="nf">t.test</span><span class="p">(</span><span class="n">expend</span> <span class="o">~</span> <span class="n">stature</span><span class="p">)</span>
</code></pre></div></p>
<p>Check that you understand the output. For an alpha level of 0.01, do you reject the null hypothesis?</p>
<h2 id="exercise-3-paired-t-test">Exercise 3: Paired t-test</h2>
<p>Paired tests are used when there are two measurements (a &lsquo;pair&rsquo;) on the same individual. A paired test is essentially a one-sample test of the differences between the measurements.</p>
<p>Any assumptions to be tested ?</p>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># assumption 1: Each of the paired measurements must be obtained from the same subject</span>
<span class="c1"># check your sampling design !</span>

<span class="c1"># assumption 2: The measured differences are normally distributed.</span>

<span class="n">intake.diff</span> <span class="o">&lt;-</span> <span class="n">intake</span><span class="o">$</span><span class="n">post</span> <span class="o">-</span> <span class="n">intake</span><span class="o">$</span><span class="n">pre</span>
<span class="n">intake.diff.df</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">intake.diff</span><span class="p">)</span>

<span class="nf">shapiro_test</span><span class="p">(</span><span class="n">intake.diff</span><span class="p">)</span>
</code></pre></div>
</details>
<p>We can carry out a paired t-test on the differences between pre and post from the intake data as follows:
<div class="highlight"><pre><span></span><code><span class="nf">t.test</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">paired</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</code></pre></div></p>
<p>Again, make sure that you know how to interpret the output. Assuming an alpha level of 0.01, what do you conclude?</p>
<p>It was important here to tell t.test that this was a paired test. What happens if you leave out paired=TRUE from the t.test command? Are the assumptions for a two-sample test satisfied in this situation?</p>
<h2 id="exercise-4-simulation-of-mice-weight-data-and-p-values">Exercise 4: Simulation of mice weight data and p values</h2>
<p>We are going to simulate in a very simple way weight data for WT and KO mice. We will use a two-sample t-test for testing the difference in mean weight between the 2 groups of mice.</p>
<div class="highlight"><pre><span></span><code><span class="n">KO</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="n">min</span><span class="o">=</span><span class="m">27</span><span class="p">,</span> <span class="n">max</span><span class="o">=</span><span class="m">34</span><span class="p">)</span>
<span class="n">WT</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="n">min</span><span class="o">=</span><span class="m">27</span><span class="p">,</span> <span class="n">max</span><span class="o">=</span><span class="m">34</span><span class="p">)</span>
<span class="n">KO</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">KO</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">KO</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;weight&quot;</span>
<span class="n">KO</span><span class="o">$</span><span class="n">genotype</span> <span class="o">&lt;-</span> <span class="s">&quot;KO&quot;</span>
<span class="n">WT</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">WT</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">WT</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;weight&quot;</span>
<span class="n">WT</span><span class="o">$</span><span class="n">genotype</span> <span class="o">&lt;-</span> <span class="s">&quot;WT&quot;</span>

<span class="n">KO_WT</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">KO</span><span class="p">,</span><span class="n">WT</span><span class="p">)</span>

<span class="nf">boxplot</span><span class="p">(</span><span class="n">KO_WT</span><span class="o">$</span><span class="n">weight</span> <span class="o">~</span> <span class="n">KO_WT</span><span class="o">$</span><span class="n">genotype</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Mice weight at 18 weeks&quot;</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="n">res.welch.test</span> <span class="o">&lt;-</span> <span class="nf">t.test</span><span class="p">(</span><span class="n">KO_WT</span><span class="o">$</span><span class="n">weight</span> <span class="o">~</span> <span class="n">KO_WT</span><span class="o">$</span><span class="n">genotype</span><span class="p">)</span>
<span class="n">res.t.test</span> <span class="o">&lt;-</span> <span class="nf">t.test</span><span class="p">(</span><span class="n">KO_WT</span><span class="o">$</span><span class="n">weight</span> <span class="o">~</span> <span class="n">KO_WT</span><span class="o">$</span><span class="n">genotype</span><span class="p">,</span> <span class="n">var.equal</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</code></pre></div>
<p>Display or summarise the resulting p-values.</p>
<p>We will now simulate weight data for WT and KO mice 1000 times and look at the distribution of p-values:</p>
<div class="highlight"><pre><span></span><code><span class="n">sim.p.welch.test</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>
<span class="n">sim.p.t.test</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">KO</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="n">min</span><span class="o">=</span><span class="m">27</span><span class="p">,</span> <span class="n">max</span><span class="o">=</span><span class="m">34</span><span class="p">)</span>
  <span class="n">WT</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="n">min</span><span class="o">=</span><span class="m">27</span><span class="p">,</span> <span class="n">max</span><span class="o">=</span><span class="m">34</span><span class="p">)</span>
  <span class="n">KO</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">KO</span><span class="p">)</span>
  <span class="nf">names</span><span class="p">(</span><span class="n">KO</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;weight&quot;</span>
  <span class="n">KO</span><span class="o">$</span><span class="n">genotype</span> <span class="o">&lt;-</span> <span class="s">&quot;KO&quot;</span>
  <span class="n">WT</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">WT</span><span class="p">)</span>
  <span class="nf">names</span><span class="p">(</span><span class="n">WT</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;weight&quot;</span>
  <span class="n">WT</span><span class="o">$</span><span class="n">genotype</span> <span class="o">&lt;-</span> <span class="s">&quot;WT&quot;</span>

  <span class="n">KO_WT</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">KO</span><span class="p">,</span><span class="n">WT</span><span class="p">)</span>

  <span class="n">res.welch.test</span> <span class="o">&lt;-</span> <span class="nf">t.test</span><span class="p">(</span><span class="n">KO_WT</span><span class="o">$</span><span class="n">weight</span> <span class="o">~</span> <span class="n">KO_WT</span><span class="o">$</span><span class="n">genotype</span><span class="p">)</span>
  <span class="n">res.t.test</span> <span class="o">&lt;-</span> <span class="nf">t.test</span><span class="p">(</span><span class="n">KO_WT</span><span class="o">$</span><span class="n">weight</span> <span class="o">~</span> <span class="n">KO_WT</span><span class="o">$</span><span class="n">genotype</span><span class="p">,</span> <span class="n">var.equal</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>

  <span class="n">sim.p.welch.test</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">sim.p.welch.test</span><span class="p">,</span> <span class="n">res.welch.test</span><span class="o">$</span><span class="n">p.value</span><span class="p">)</span>
  <span class="n">sim.p.t.test</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">sim.p.t.test</span><span class="p">,</span> <span class="n">res.t.test</span><span class="o">$</span><span class="n">p.value</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">sum</span><span class="p">(</span><span class="n">sim.p.welch.test</span> <span class="o">&lt;</span> <span class="m">0.05</span><span class="p">)</span>
<span class="nf">sum</span><span class="p">(</span><span class="n">sim.p.t.test</span> <span class="o">&lt;</span> <span class="m">0.05</span><span class="p">)</span>
</code></pre></div>
<p>How many tests are significant ? What if you apply a Bonferroni correction ? What if you apply a FDR correction ? (use the p.adjust function if needed).</p>
<p>Change the parameters of the simulations and see what is the effect on the p-values.</p>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="n">adj.bonf</span> <span class="o">&lt;-</span> <span class="nf">p.adjust</span><span class="p">(</span><span class="n">sim.p.welch.test</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;bonf&quot;</span><span class="p">)</span>
<span class="nf">sum</span><span class="p">(</span><span class="n">adj.bonf</span> <span class="o">&lt;</span> <span class="m">0.05</span><span class="p">)</span>
<span class="n">adj.BH</span> <span class="o">&lt;-</span> <span class="nf">p.adjust</span><span class="p">(</span><span class="n">sim.p.welch.test</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;BH&quot;</span><span class="p">)</span>
<span class="nf">sum</span><span class="p">(</span><span class="n">adj.BH</span> <span class="o">&lt;</span> <span class="m">0.05</span><span class="p">)</span>
</code></pre></div>
</details>
<h2 id="exercise-5-anova">Exercise 5: ANOVA</h2>
<p>Install the library faraway</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">faraway</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="n">coagulation</span><span class="p">)</span>
</code></pre></div>
<p>The dataset comes from Faraway (2002) and comprises a set of 24 blood coagulation times. 24 animals were randomly assigned to four different diets and the samples were taken in a random order.</p>
<ol>
<li>Load the data and explore the dataset</li>
</ol>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="nf">data</span><span class="p">(</span><span class="n">coagulation</span><span class="p">)</span>

<span class="c1"># check the data</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">coagulation</span><span class="p">)</span>

<span class="n">coagulation</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">diet</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">get_summary_stats</span><span class="p">(</span><span class="n">coag</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;mean_sd&quot;</span><span class="p">)</span> 

<span class="nf">boxplot</span><span class="p">(</span><span class="n">coagulation</span><span class="o">$</span><span class="n">coag</span> <span class="o">~</span> <span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="p">)</span>

<span class="nf">ggboxplot</span><span class="p">(</span><span class="n">coagulation</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">&quot;diet&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">&quot;coag&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<ol start="2">
<li>Fit an ANOVA model, this also means checking assumptions!</li>
</ol>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># check normality</span>

<span class="o">?</span><span class="n">ggqqplot</span>
<span class="nf">ggqqplot</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;A&quot;</span><span class="p">,],</span> <span class="s">&quot;coag&quot;</span><span class="p">)</span>
<span class="nf">ggqqplot</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;B&quot;</span><span class="p">,],</span> <span class="s">&quot;coag&quot;</span><span class="p">)</span>
<span class="nf">ggqqplot</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;C&quot;</span><span class="p">,],</span> <span class="s">&quot;coag&quot;</span><span class="p">)</span>
<span class="nf">ggqqplot</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;D&quot;</span><span class="p">,],</span> <span class="s">&quot;coag&quot;</span><span class="p">)</span>

<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="s">&quot;coag&quot;</span><span class="p">])</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="s">&quot;coag&quot;</span><span class="p">])</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="s">&quot;coag&quot;</span><span class="p">])</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">coagulation</span><span class="p">[</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="o">==</span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="s">&quot;coag&quot;</span><span class="p">])</span>

<span class="c1"># check variance equality</span>
<span class="nf">levene_test</span><span class="p">(</span><span class="n">coagulation</span><span class="p">,</span><span class="n">coag</span><span class="o">~</span><span class="n">diet</span><span class="p">)</span>
<span class="c1"># if the command above does not work, use the levene test from the car package</span>
<span class="n">car</span><span class="o">::</span><span class="nf">leveneTest</span><span class="p">(</span><span class="n">coag</span><span class="o">~</span><span class="n">diet</span><span class="p">,</span> <span class="n">coagulation</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="s">&quot;median&quot;</span><span class="p">)</span>

<span class="c1"># do anova</span>
<span class="n">anova_diet</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">coagulation</span><span class="o">$</span><span class="n">coag</span><span class="o">~</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="p">)</span>

<span class="nf">summary</span><span class="p">(</span><span class="n">anova_diet</span><span class="p">)</span>
</code></pre></div>
</details>
<ol start="3">
<li>Is there some differences between the groups? If yes, which group(s) is different ?</li>
</ol>
<details class="done">
<summary>Answer</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># check pairwise </span>

<span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">anova_diet</span><span class="p">)</span>

<span class="nf">pairwise.t.test</span><span class="p">(</span><span class="n">coagulation</span><span class="o">$</span><span class="n">coag</span><span class="p">,</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="p">,</span><span class="n">p.adj</span><span class="o">=</span><span class="s">&quot;bonf&quot;</span><span class="p">)</span>
<span class="nf">pairwise.t.test</span><span class="p">(</span><span class="n">coagulation</span><span class="o">$</span><span class="n">coag</span><span class="p">,</span><span class="n">coagulation</span><span class="o">$</span><span class="n">diet</span><span class="p">,</span><span class="n">p.adj</span><span class="o">=</span><span class="s">&quot;holm&quot;</span><span class="p">)</span>
</code></pre></div>
</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../day1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Day 1" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Day 1
            </div>
          </div>
        </a>
      
      
        
        <a href="../day3/" class="md-footer__link md-footer__link--next" aria-label="Next: Day 3" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Day 3
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>